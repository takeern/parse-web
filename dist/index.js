!function(c){function e(e){for(var t,r,a=e[0],n=e[1],o=e[2],s=0,i=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(p,r)&&p[r]&&i.push(p[r][0]),p[r]=0;for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(c[t]=n[t]);for(d&&d(e);i.length;)i.shift()();return u.push.apply(u,o||[]),l()}function l(){for(var e,t=0;t<u.length;t++){for(var r=u[t],a=!0,n=1;n<r.length;n++){var o=r[n];0!==p[o]&&(a=!1)}a&&(u.splice(t--,1),e=s(s.s=r[0]))}return e}var r={},p={0:0},u=[];function s(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=c,s.c=r,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(r,a,function(e){return t[e]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/dist";var t=window.webpackJsonp=window.webpackJsonp||[],a=t.push.bind(t);t.push=e,t=t.slice();for(var n=0;n<t.length;n++)e(t[n]);var d=a;u.push([61,1]),l()}({56:function(e,t,r){},61:function(e,t,r){"use strict";r.r(t);var y=r(0),g=r.n(y),a=r(28),n=r.n(a),s=r(26),o=r(64),i=r(15),c=r(11),l=r(34),p=r(16),u=r(8),d=r.n(u),f="GOT_LOGO_SRC";function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}var m,b={message:"Hello Duck",poweredBy:"thanks for fire！",img_src:null},v=Object(c.c)({home:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:b,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case f:return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach(function(e){d()(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},e,{img_src:t.payload});default:return e}}}),O=r(5),w=r(20),E=r.n(w),k=r(21),j=r.n(k),x=r(22),P=r.n(x),S=r(23),_=r.n(S),C=r(24),D=r.n(C),I=(r(56),Object(i.connect)(function(e){var t=e.home;return{message:t.message,poweredBy:t.poweredBy,img_src:t.img_src}})(m=function(e){function t(){return E()(this,t),P()(this,_()(t).apply(this,arguments))}return D()(t,e),j()(t,[{key:"render",value:function(){var e=this.props.img_src;return g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:"demo"},g.a.createElement("p",{className:"message"}," ",this.props.message," "),g.a.createElement("p",{className:"footer"}," ",this.props.poweredBy," "),g.a.createElement("div",null,g.a.createElement("img",{src:e}))))}}],[{key:"loadData",value:function(r){return new Promise(function(t){fetch("http://127.0.0.1:2323/testRedux",{method:"POST"}).then(function(e){if(e.ok)return e.json();throw new Error("net not work")}).then(function(e){return r.dispatch({type:f,payload:e.img_src}),t()}).catch(function(){return console.log("%c you can try npm run server","background:#aaa;color:#bada55"),r.dispatch({type:f,payload:"./src/static/img/duck.png"}),t()})})}}]),t}(y.PureComponent))||m),z=r(12),H=r.n(z),N=r(25),A=r.n(N),L=r(7),T=r.n(L);function R(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}function M(e){var t=e.props,r=t.header,a=t.body,n=t.height;return g.a.createElement("div",{style:{display:"flex",width:"100%",height:n+"rem",overflow:"hidden"}},g.a.createElement(B,{props:r}),g.a.createElement(F,{props:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?R(Object(r),!0).forEach(function(e){d()(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},a,{type:r.type})}))}function B(e){var t,r=e.props,a=r.type,n=r.size,o=r.timestamp,s=r.timestampEx,i=r.filePostion;switch(a){case 8:t="Audio";break;case 9:t="Video";break;case 18:t="Script";break;default:t=null}return g.a.createElement("div",{className:"tag-header",style:{display:"flex",flexWrap:"wrap",width:300,alignContent:"center",justifyContent:"center",backgroundColor:"rgb(243, 90, 119)",position:"relative"}},g.a.createElement(G,{props:{key:"tagType",value:a}}),g.a.createElement(G,{props:{key:"tagSize",value:n}}),g.a.createElement(G,{props:{key:"dts",value:o}}),g.a.createElement(G,{props:{key:"dtsEx",value:s}}),g.a.createElement(G,{props:{key:"filePostion",value:i}}),t&&g.a.createElement("span",{style:{top:"0px",right:"-5px",padding:"2px",position:"absolute",color:"white",backgroundColor:"black",fontSize:"0.5rem"}},t))}function F(e){return 8===e.props.type?g.a.createElement(W,{props:e.props}):g.a.createElement(q,{props:e.props})}function G(e){var t=e.props,r=t.key,a=t.value,n=t.fontSize;return n=n||"0.5rem",void 0!==r&&null!=a?g.a.createElement("div",{style:{backgroundColor:"rgb(119, 108, 108)",color:"white",padding:"1px 2px",margin:2,borderRadius:6,fontSize:n,textAlign:"center",height:17}},g.a.createElement("span",null,r,": "),g.a.createElement("span",null,a.toString())):null}function V(e){var t,r=e.props,a=r.size,n=r.filePostion,o=r.unitType,s=r.index;switch(o){case 1:case 2:case 3:case 4:t="非IDR图像";break;case 5:t="IDR";break;case 6:t="SEI";break;case 7:t="SPS";break;case 8:t="PPS";break;case 9:t="分界符";break;case 11:t="END";break;case 12:t="填充";break;default:t="UNHANDLE nal type"+o}return g.a.createElement("div",{style:{backgroundColor:"#ff8e53"},"data-nalu-index":s},g.a.createElement(G,{props:{key:"filePostion",value:n}}),g.a.createElement(G,{props:{key:"size",value:a}}),g.a.createElement(G,{props:{key:"nalu",value:t}}))}function W(e){var t=e.props,r=t.soundFormat,a=t.soundRate,n=t.soundSize,o=t.soundType,s=t.length,i=t.dts,c=t.pts,l=t.filePostion;return g.a.createElement("div",{className:"audio-tag",style:{width:"100%",backgroundColor:"#69d6e4",display:"flex",justifyContent:"center",alignItems:"center"}},g.a.createElement(G,{props:{key:"soundFormat",value:r}}),g.a.createElement(G,{props:{key:"soundRate",value:a}}),g.a.createElement(G,{props:{key:"soundSize",value:n}}),g.a.createElement(G,{props:{key:"soundType",value:o}}),g.a.createElement(G,{props:{key:"size",value:s}}),g.a.createElement(G,{props:{key:"dts",value:i}}),g.a.createElement(G,{props:{key:"pts",value:c}}),g.a.createElement(G,{props:{key:"filePostion",value:l}}))}function q(e){var t=e.props,r=(t.filePostion,t.frameType),a=t.dts,n=t.cts,o=(t.size,t.nalus);5<(o=o||[]).length&&(o.length=5,console.warn("展示 nalu 数量超过限制",o));var s=o.map(function(e,t){return e.index=t,g.a.createElement(V,{key:t,props:e})});return g.a.createElement("div",{className:"video-tag",style:{display:"flex",alignItems:"center",justifyContent:"space-around",overflow:"hidden",width:"100%",backgroundColor:"#9a049a"}},g.a.createElement("div",null,g.a.createElement(G,{props:{key:"keyframe",value:1===r}}),g.a.createElement(G,{props:{key:"dts",value:a}}),g.a.createElement(G,{props:{key:"pts",value:a+n}})),s)}function J(e){var t=e.props,r=t.hasVideo,a=t.hasAudio,n=t.height;return g.a.createElement("div",{className:"flv-header",style:{width:"100%",height:n+"rem",display:"flex",alignItems:"center",backgroundColor:"#8BC34A",color:"white"}},g.a.createElement("div",{style:{fontSize:"3rem",margin:"0px 10px",width:"11rem"}},"F    L    V"),g.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},g.a.createElement(G,{props:{key:"hasVideo",value:r}}),g.a.createElement(G,{props:{key:"hasAudio",value:a}}),g.a.createElement(G,{props:{key:"filePostion",value:0}}),g.a.createElement(G,{props:{key:"size",value:11}})))}function U(e){var t=[];for(var r in e.props.data=e.props.data||{},e.props.data)t.push(g.a.createElement(G,{key:r,props:{key:r,value:e.props.data[r]}}));return g.a.createElement("div",{className:"meta",style:{display:"flex",alignItems:"center",position:"relative",flexWrap:"wrap",width:"100%",backgroundColor:"#FFC107",overflow:"hidden"}},g.a.createElement("span",{style:{padding:"2px",color:"white",backgroundColor:"black",fontSize:"0.5rem"}},"Metadata"),t)}function K(e){var t=e.props.data,r=t.profile_string,a=t.level_string,n=t.bit_depth,o=t.chroma_format_string,s=t.frame_rate,i=t.sar_ratio,c=t.codec_size;t.present_size;return g.a.createElement("div",{className:"avc-config",style:{display:"flex",alignItems:"center",position:"relative",flexWrap:"wrap",width:"100%",backgroundColor:"#673AB7",overflow:"hidden",minHeight:"2rem"}},g.a.createElement("span",{style:{padding:"2px",color:"white",backgroundColor:"black",fontSize:"0.5rem"}},"AvcConfig"),g.a.createElement(G,{props:{key:"profile",value:r}}),g.a.createElement(G,{props:{key:"level",value:a}}),g.a.createElement(G,{props:{key:"bit_depth",value:n}}),g.a.createElement(G,{props:{key:"chroma_format",value:o}}),g.a.createElement(G,{props:{key:"fps",value:s.fps}}),g.a.createElement(G,{props:{key:"sar_radio_width",value:i.width}}),g.a.createElement(G,{props:{key:"sar_radio_height",value:i.height}}),g.a.createElement(G,{props:{key:"codec_size_width",value:c.width}}),g.a.createElement(G,{props:{key:"codec_size_height",value:c.height}}))}function Q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}function X(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(r),!0).forEach(function(e){d()(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var Y=function(e){var t=e.props,r=t.data,a=t.el,n=t.baseHeight,o=t.config,s=o.boxHeight,i=o.scrollLen*s+"rem",c=Object(y.useState)({startIndex:-o.scrollLen}),l=T()(c,2),p=l[0],u=l[1];if(r&&0!==r.length){for(var d=[],f=p.startIndex,h=f+o.maxLen>r.length?r.length:f+o.maxLen,m=f=0<f?f:0;m<h;m++)d.push(g.a.createElement("div",{style:{position:"absolute",top:m*s+"rem",left:0,width:"100%"},key:m,"data-tag-index":m},a({props:X({},r[m],{height:s,index:m})})));return g.a.createElement("div",{id:"scroll-wrap",onScroll:function(e){var t=e.target.scrollTop,r=Math.floor(t/(n*s))-o.scrollLen;Math.abs(r-p.startIndex)>=o.scrollLen&&u({startIndex:r})},onClick:e.handleClick,style:{height:i,position:"relative",width:"100%",willChange:"transform",overflow:"hidden auto",opacity:"0.95"}},g.a.createElement("div",{style:{width:"auto",height:r.length*s+"rem",maxWidth:"100%",maxHeight:r.length*s+"rem",overflow:"hidden",position:"relative"}},d))}return null};function Z(e){var t=e.props,r=t.size,a=t.filePostion,n=t.baseHeight,o=Object(y.useState)(),s=T()(o,2),i=s[0],c=s[1],l=Object(y.useState)(16),p=T()(l,2),u=p[0];p[1];if(Object(y.useEffect)(function(){r&&a&&function(){var e=A()(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://127.0.0.1:3000/getBuffer",{headers:{Range:"bytes=".concat(a,"-").concat(a+r-1)}}).then(function(e){return e.arrayBuffer()}).then(function(e){return c(new Uint8Array(e))});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},[r,a]),!i)return null;for(var d=[],f=[],h=0;h<i.length;h++)0!==h&&h%10==0&&(d.push({data:{arr:[].concat(f),base:u}}),f.length=0),f.push(i[h].toString(u));0!==f.length&&d.push({data:{arr:[].concat(f),base:u}});var m=new Array(11).fill(0).map(function(e,t){return $(t,t,u)});return g.a.createElement("div",{style:{backgroundColor:"black",color:"white"}},m,g.a.createElement(Y,{props:{data:d,el:ee,length:length,baseHeight:n,config:{boxHeight:1.5,scrollLen:10,maxLen:30}}}))}var $=function(e,t){return g.a.createElement("span",{style:{width:"55px",display:"inline-block",textAlign:"end"},key:t},e)},ee=function(e){var t=e.props,r=t.data,a=t.index,n=16===r.base?"1rem":"0.5rem",o=r.arr.map(function(e,t){return $(e,t+1,r.base)});return o.unshift($(a+1,0,r.base)),g.a.createElement("div",{className:"bf-content",style:{fontSize:n}},o)};function te(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}function re(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?te(Object(r),!0).forEach(function(e){d()(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function ae(e){var a={boxHeight:5,scrollLen:5,maxLen:25},t=Object(y.useState)(null),r=T()(t,2),o=r[0],n=r[1],s=Object(y.useState)(),i=T()(s,2),c=i[0],l=i[1],p=Object(y.useState)({startIndex:-a.scrollLen}),u=T()(p,2),d=u[0],f=u[1];Object(y.useEffect)(function(){(function(){var e=A()(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://127.0.0.1:3000/getParseData").then(function(e){return e&&e.json()}).then(function(e){100===e.code&&(console.log(e.data),e.data=ne(e.data),e.data.baseHeight=parseInt(getComputedStyle(document.body).fontSize),console.log(e.data),n(e.data))});case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()},[]);return o?g.a.createElement("div",{className:"container",style:{}},g.a.createElement("div",{className:"content",style:{width:1e3}},g.a.createElement(J,{props:{hasVideo:o.header.hasVideo,hasAudio:o.header.hasAudio,height:"3rem"}}),g.a.createElement(U,{props:{height:a.boxHeight,data:re({},o.metaData,{},o.audioAcc)}}),g.a.createElement(K,{props:{data:re({},o.spsConfig)}}),g.a.createElement(Y,{handleScroll:function(e){var t=e.target.scrollTop,r=Math.floor(t/o.baseHeight)-a.scrollLen;console.log(r,d.startIndex),Math.abs(r-d.startIndex)>a.scrollLen&&f({startIndex:r})},handleClick:function(e){for(var t,r,a=e.target;"scroll-wrap"!==a.id;)a.getAttribute("data-nalu-index")&&(r=parseInt(a.getAttribute("data-nalu-index"),10)),a.getAttribute("data-tag-index")&&(t=parseInt(a.getAttribute("data-tag-index"),10)),a=a.parentNode;if(!isNaN(t)&&!isNaN(r)){console.log(t,r);var n=o.tagsData[t].body.nalus[r];l(n)}},props:{data:o.tagsData,startIndex:d.startIndex,maxLen:5,el:M,baseHeight:o.baseHeight,config:a}})),g.a.createElement("div",{style:{width:650}},g.a.createElement(Z,{props:re({},c,{baseHeight:o.baseHeight})}))):null}function ne(e){for(var t=[],r=0,a=0,n=ae.staticProps.tagStart;n<e.tagHeaders.length;n++){var o=e.tagHeaders[n].type,s=null;switch(o){case 8:s=e.audioTags[r],r++;break;case 9:s=e.avcPackets[a],a++;break;default:console.warn("readParseData: unhandle unitType: ".concat(o))}t.push({header:e.tagHeaders[n],body:s})}return e.tagsData=t,e}ae.staticProps={tagStart:3};function oe(n,e,o){var t=Object(s.a)(e,o.pathname).map(function(e){var t=e.route,r=e.match,a=t.component.loadData;return a?a(n,r,o):Promise.resolve(null)});return Promise.all(t)}function se(e){var t,r,a=Object(O.a)(),n=(t=a,r=e,Object(c.d)(Object(p.connectRouter)(t)(v),r,Object(c.a)(l.a,Object(p.routerMiddleware)(t))));return g.a.createElement(i.Provider,{store:n},g.a.createElement(p.ConnectedRouter,{history:a},g.a.createElement(o.a,null,g.a.createElement(ue,{routes:ie,store:n,initState:e},Object(s.b)(ie)))))}var ie=[{path:"/",component:I,exact:!0},{path:"/parse",component:ae,exact:!0}],ce=r(13),le=r(31),pe=function(e){function r(e){var t;return E()(this,r),(t=P()(this,_()(r).call(this,e))).state={showChildren:!1,firstGetInfo:!0,lastPath:null},t}return D()(r,e),j()(r,[{key:"componentWillReceiveProps",value:function(e){var t=this,r=this.props,a=r.routes,n=r.store;r.location,r.children;e.location!==this.props.location&&oe(n,a,e.location).then(function(){t.setState({nextlocation:e.location})})}},{key:"render",value:function(){var e=this,t=this.props,r=t.routes,a=t.store,n=t.location,o=t.children;this.state.firstGetInfo&&(this.props.initState?this.setState({showChildren:!0,firstGetInfo:!1,nextlocation:n}):oe(a,r,n).then(function(){e.setState({showChildren:!0,firstGetInfo:!1,nextlocation:n})}));var s=this.state.showChildren&&this.state.nextlocation===this.props.location;return g.a.createElement(ce.a,{location:n,render:function(){return s?o:null}})}}]),r}(y.Component),ue=Object(le.a)(pe);window.__initState__?n.a.hydrate(se(window.__initState__),document.querySelector(".server-app")):n.a.render(se(),document.querySelector(".server-app"))}});